{"prompt": "refactor(drainer): change logic for trimming the stream and refactor for modularity (#3128)\n\nCo-authored-by: hyperswitch-bot[bot] <148525504+hyperswitch-bot[bot]@users.noreply.github.com>", "response": "Files to modify:\n\n\n**kv.rs**\n  Add:\n    - function: pub::operation\n    - function: pub::table\n    - enum: pub::DBResult\n    - impl: impl DBOperation\n\n**errors.rs**\n  Modify existing code\n\n**handler.rs**\n  Add:\n    - function: private::deref\n    - function: pub::from_conf\n    - function: pub::close\n    - function: pub::spawn\n    - function: pub::shutdown_listener\n    - function: pub::spawn_error_handlers\n    - function: pub::redis_error_receiver\n    - function: private::drainer_handler\n    - function: private::drainer\n    - struct: pub::Handler\n    - struct: pub::HandlerInner\n    - impl: impl std::ops::Deref for Handler\n    - impl: impl Handler\n\n**lib.rs**\n  Remove:\n    - function: pub::start_drainer\n    - function: pub::redis_error_receiver\n    - function: private::drainer_handler\n    - mod: private::macro_util\n  Add:\n    - mod: private::handler\n    - mod: private::query\n    - mod: private::stream\n    - mod: private::types\n\n**main.rs**\n  Modify existing code\n\n**query.rs**\n  Add:\n    - function: private::execute_query\n    - function: private::push_drainer_delay\n    - trait: pub::ExecuteQuery\n    - impl: impl ExecuteQuery for kv::DBOperation\n\n**services.rs**\n  Remove:\n    - function: pub::drainer_stream\n\n**stream.rs**\n  Add:\n    - function: pub::drainer_stream\n    - function: pub::get_stream_key_flag\n    - function: pub::get_drainer_stream_name\n    - function: pub::is_stream_available\n    - function: pub::make_stream_available\n    - function: pub::read_from_stream\n    - function: pub::trim_from_stream\n    - impl: impl Store\n\n**types.rs**\n  Add:\n    - function: pub::from_hashmap\n    - struct: pub::StreamData\n    - impl: impl StreamData\n\n**utils.rs**\n  Remove:\n    - function: pub::is_stream_available\n    - function: pub::read_from_stream\n    - function: pub::trim_from_stream\n    - function: pub::make_stream_available\n    - function: pub::get_stream_key_flag\n    - function: pub::get_drainer_stream_name\n  Add:\n    - function: pub::deserialize_i64"}
