{"prompt": "feat(payments_v2): add payment_confirm_intent api endpoint (#6263)\n\nCo-authored-by: hrithikesh026 <hrithikesh.vm@juspay.in>\nCo-authored-by: hyperswitch-bot[bot] <148525504+hyperswitch-bot[bot]@users.noreply.github.com>\nCo-authored-by: sai-harsha-vardhan <harsha111hero@gmail.com>\nCo-authored-by: Shankar Singh C <83439957+ShankarSinghC@users.noreply.github.com>\nCo-authored-by: spritianeja03 <146620839+spritianeja03@users.noreply.github.com>\nCo-authored-by: Spriti Aneja <spriti.aneja@juspay.in>", "response": "Files to modify:\n\n\n**payment.rs**\n  Remove:\n    - impl: impl ApiEventMetric for PaymentsRequest\n  Add:\n    - function: private::get_api_event_type\n    - impl: impl ApiEventMetric for payments::PaymentsRequest\n    - impl: impl ApiEventMetric for PaymentsConfirmIntentResponse\n\n**payments.rs**\n  Remove:\n    - function: pub::get_total_capturable_amount\n    - function: pub::with_source\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::HeaderPayload\n    - impl: impl PaymentsRequest\n    - impl: impl HeaderPayload\n    - impl: impl PaymentsRequest\n  Add:\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::AmountDetailsResponse\n    - struct: pub::ConfirmIntentAmountDetailsResponse\n    - struct: pub::PaymentsConfirmIntentRequest\n    - struct: pub::ErrorDetails\n    - struct: pub::PaymentsConfirmIntentResponse\n\n**enums.rs**\n  Modify existing code\n\n**events.rs**\n  Add:\n    - function: private::get_api_event_type\n    - impl: impl ApiEventMetric for id_type::GlobalPaymentId\n\n**id_type.rs**\n  Modify existing code\n\n**global_id.rs**\n  Modify existing code\n\n**payment.rs**\n  Remove:\n    - impl: impl ApiEventMetric for PaymentsRequest\n  Add:\n    - function: private::get_api_event_type\n    - impl: impl ApiEventMetric for payments::PaymentsRequest\n    - impl: impl ApiEventMetric for PaymentsConfirmIntentResponse\n\n**macros.rs**\n  Modify existing code\n\n**types.rs**\n  Add:\n    - function: pub::get_string_repr\n    - function: private::from_str\n    - function: pub::get_string_repr\n    - struct: pub::BrowserInformation\n    - impl: impl Url\n    - impl: impl FromStr for ClientSecret\n\n**payment_attempt.rs**\n  Modify existing code\n\n**payment_intent.rs**\n  Add:\n    - function: pub::get_tax_amount\n    - function: private::get_default_tax_amount\n    - impl: impl TaxDetails\n\n**payment_attempt.rs**\n  Modify existing code\n\n**sample_data.rs**\n  Modify existing code\n\n**schema_v2.rs**\n  Modify existing code\n\n**sample_data.rs**\n  Modify existing code\n\n**helcim.rs**\n  Modify existing code\n\n**nexinets.rs**\n  Modify existing code\n\n**lib.rs**\n  Modify existing code\n\n**payments.rs**\n  Remove:\n    - function: pub::get_total_capturable_amount\n    - function: pub::with_source\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::HeaderPayload\n    - impl: impl PaymentsRequest\n    - impl: impl HeaderPayload\n    - impl: impl PaymentsRequest\n  Add:\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::AmountDetailsResponse\n    - struct: pub::ConfirmIntentAmountDetailsResponse\n    - struct: pub::PaymentsConfirmIntentRequest\n    - struct: pub::ErrorDetails\n    - struct: pub::PaymentsConfirmIntentResponse\n\n**payment_attempt.rs**\n  Modify existing code\n\n**payment_intent.rs**\n  Add:\n    - function: pub::get_tax_amount\n    - function: private::get_default_tax_amount\n    - impl: impl TaxDetails\n\n**router_data.rs**\n  Modify existing code\n\n**router_request_types.rs**\n  Modify existing code\n\n**main.rs**\n  Modify existing code\n\n**openapi_v2.rs**\n  Modify existing code\n\n**payments.rs**\n  Remove:\n    - function: pub::get_total_capturable_amount\n    - function: pub::with_source\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::HeaderPayload\n    - impl: impl PaymentsRequest\n    - impl: impl HeaderPayload\n    - impl: impl PaymentsRequest\n  Add:\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::AmountDetailsResponse\n    - struct: pub::ConfirmIntentAmountDetailsResponse\n    - struct: pub::PaymentsConfirmIntentRequest\n    - struct: pub::ErrorDetails\n    - struct: pub::PaymentsConfirmIntentResponse\n\n**payment_intents.rs**\n  Modify existing code\n\n**setup_intents.rs**\n  Modify existing code\n\n**utils.rs**\n  Remove:\n    - function: private::get_browser_info\n    - trait: pub::AccessPaymentAttemptInfo\n    - impl: impl AccessPaymentAttemptInfo for PaymentAttempt\n\n**checkout_flow.rs**\n  Modify existing code\n\n**record_return.rs**\n  Modify existing code\n\n**sale_flow.rs**\n  Modify existing code\n\n**transaction_flow.rs**\n  Modify existing code\n\n**fraud_check_post.rs**\n  Modify existing code\n\n**cards.rs**\n  Modify existing code\n\n**surcharge_decision_configs.rs**\n  Modify existing code\n\n**payments.rs**\n  Remove:\n    - function: pub::get_total_capturable_amount\n    - function: pub::with_source\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::HeaderPayload\n    - impl: impl PaymentsRequest\n    - impl: impl HeaderPayload\n    - impl: impl PaymentsRequest\n  Add:\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::AmountDetailsResponse\n    - struct: pub::ConfirmIntentAmountDetailsResponse\n    - struct: pub::PaymentsConfirmIntentRequest\n    - struct: pub::ErrorDetails\n    - struct: pub::PaymentsConfirmIntentResponse\n\n**flows.rs**\n  Modify existing code\n\n**approve_flow.rs**\n  Modify existing code\n\n**authorize_flow.rs**\n  Add:\n    - function: private::construct_router_data\n    - function: private::get_merchant_recipient_data\n    - impl: impl ConstructFlowSpecificData<\napi::Authorize,\ntypes::PaymentsAuthorizeData,\ntypes::PaymentsResponseData,\n> for PaymentConfirmData<api::Authorize>\n\n**cancel_flow.rs**\n  Modify existing code\n\n**capture_flow.rs**\n  Modify existing code\n\n**complete_authorize_flow.rs**\n  Modify existing code\n\n**incremental_authorization_flow.rs**\n  Modify existing code\n\n**post_session_tokens_flow.rs**\n  Modify existing code\n\n**psync_flow.rs**\n  Modify existing code\n\n**reject_flow.rs**\n  Modify existing code\n\n**session_flow.rs**\n  Modify existing code\n\n**session_update_flow.rs**\n  Modify existing code\n\n**setup_mandate_flow.rs**\n  Modify existing code\n\n**helpers.rs**\n  Remove:\n    - function: pub::get_token_pm_type_mandate_details\n    - function: private::make_new_payment_attempt\n\n**operations.rs**\n  Add:\n    - trait: pub::ValidateStatusForOperation\n    - mod: pub::payment_confirm_intent\n\n**payment_approve.rs**\n  Modify existing code\n\n**payment_cancel.rs**\n  Modify existing code\n\n**payment_capture.rs**\n  Modify existing code\n\n**payment_complete_authorize.rs**\n  Modify existing code\n\n**payment_confirm.rs**\n  Modify existing code\n\n**payment_confirm_intent.rs**\n  Add:\n    - function: private::validate_status_for_operation\n    - function: private::to_validate_request\n    - function: private::to_get_tracker\n    - function: private::to_domain\n    - function: private::to_update_tracker\n    - function: private::to_validate_request\n    - function: private::to_get_tracker\n    - function: private::to_domain\n    - function: private::to_update_tracker\n    - function: private::validate_request\n    - function: private::get_trackers\n    - function: private::get_customer_details\n    - function: private::make_pm_data\n    - function: private::get_connector\n    - function: private::update_trackers\n    - struct: pub::PaymentIntentConfirm\n    - impl: impl ValidateStatusForOperation for PaymentIntentConfirm\n    - impl: impl Operation<F, PaymentsConfirmIntentRequest> for &PaymentIntentConfirm\n    - impl: impl Operation<F, PaymentsConfirmIntentRequest> for PaymentIntentConfirm\n    - impl: impl ValidateRequest<F, PaymentsConfirmIntentRequest, PaymentConfirmData<F>> for PaymentIntentConfirm\n    - impl: impl GetTracker<F, PaymentConfirmData<F>, PaymentsConfirmIntentRequest> for PaymentIntentConfirm\n    - impl: impl Domain<F, PaymentsConfirmIntentRequest, PaymentConfirmData<F>> for PaymentIntentConfirm\n    - impl: impl UpdateTracker<F, PaymentConfirmData<F>, PaymentsConfirmIntentRequest> for PaymentIntentConfirm\n\n**payment_create.rs**\n  Modify existing code\n\n**payment_create_intent.rs**\n  Remove:\n    - struct: pub::PaymentCreateIntent\n  Add:\n    - struct: pub::PaymentIntentCreate\n\n**payment_post_session_tokens.rs**\n  Modify existing code\n\n**payment_reject.rs**\n  Modify existing code\n\n**payment_response.rs**\n  Remove:\n    - function: private::payment_response_update_tracker\n  Add:\n    - function: private::to_post_update_tracker\n    - function: private::to_post_update_tracker\n    - function: private::update_tracker\n    - impl: impl Operation<F, types::PaymentsAuthorizeData> for &PaymentResponse\n    - impl: impl Operation<F, types::PaymentsAuthorizeData> for PaymentResponse\n    - impl: impl PostUpdateTracker<F, PaymentConfirmData<F>, types::PaymentsAuthorizeData> for PaymentResponse\n\n**payment_session.rs**\n  Modify existing code\n\n**payment_start.rs**\n  Modify existing code\n\n**payment_status.rs**\n  Modify existing code\n\n**payment_update.rs**\n  Modify existing code\n\n**payments_incremental_authorization.rs**\n  Modify existing code\n\n**tax_calculation.rs**\n  Modify existing code\n\n**retry.rs**\n  Modify existing code\n\n**routing.rs**\n  Add:\n    - function: pub::perform_session_flow_routing\n\n**transformers.rs**\n  Add:\n    - function: pub::construct_router_data_to_update_calculated_tax\n    - function: pub::construct_payment_router_data_for_authorize\n    - function: private::generate_response\n    - function: private::connector_transaction_id\n    - function: private::connector_transaction_id\n    - function: private::foreign_from\n    - impl: impl ForeignFrom<(\n&hyperswitch_domain_models::payments::AmountDetails,\n&hyperswitch_domain_models::payments::payment_attempt::AttemptAmountDetails,\n)> for api_models::payments::ConfirmIntentAmountDetailsResponse\n\n**pm_auth.rs**\n  Modify existing code\n\n**sample_data.rs**\n  Modify existing code\n\n**utils.rs**\n  Remove:\n    - function: private::get_browser_info\n    - trait: pub::AccessPaymentAttemptInfo\n    - impl: impl AccessPaymentAttemptInfo for PaymentAttempt\n\n**incoming.rs**\n  Modify existing code\n\n**kafka_store.rs**\n  Modify existing code\n\n**sample_data.rs**\n  Modify existing code\n\n**lib.rs**\n  Modify existing code\n\n**app.rs**\n  Modify existing code\n\n**lock_utils.rs**\n  Modify existing code\n\n**payments.rs**\n  Remove:\n    - function: pub::get_total_capturable_amount\n    - function: pub::with_source\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::HeaderPayload\n    - impl: impl PaymentsRequest\n    - impl: impl HeaderPayload\n    - impl: impl PaymentsRequest\n  Add:\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::AmountDetailsResponse\n    - struct: pub::ConfirmIntentAmountDetailsResponse\n    - struct: pub::PaymentsConfirmIntentRequest\n    - struct: pub::ErrorDetails\n    - struct: pub::PaymentsConfirmIntentResponse\n\n**helpers.rs**\n  Remove:\n    - function: pub::get_token_pm_type_mandate_details\n    - function: private::make_new_payment_attempt\n\n**pm_auth.rs**\n  Modify existing code\n\n**poll.rs**\n  Modify existing code\n\n**api.rs**\n  Modify existing code\n\n**authentication.rs**\n  Add:\n    - function: private::authenticate_and_fetch\n\n**types.rs**\n  Add:\n    - function: pub::get_string_repr\n    - function: private::from_str\n    - function: pub::get_string_repr\n    - struct: pub::BrowserInformation\n    - impl: impl Url\n    - impl: impl FromStr for ClientSecret\n\n**api.rs**\n  Modify existing code\n\n**payments.rs**\n  Remove:\n    - function: pub::get_total_capturable_amount\n    - function: pub::with_source\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::HeaderPayload\n    - impl: impl PaymentsRequest\n    - impl: impl HeaderPayload\n    - impl: impl PaymentsRequest\n  Add:\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::AmountDetailsResponse\n    - struct: pub::ConfirmIntentAmountDetailsResponse\n    - struct: pub::PaymentsConfirmIntentRequest\n    - struct: pub::ErrorDetails\n    - struct: pub::PaymentsConfirmIntentResponse\n\n**storage.rs**\n  Modify existing code\n\n**payment_attempt.rs**\n  Modify existing code\n\n**transformers.rs**\n  Add:\n    - function: pub::construct_router_data_to_update_calculated_tax\n    - function: pub::construct_payment_router_data_for_authorize\n    - function: private::generate_response\n    - function: private::connector_transaction_id\n    - function: private::connector_transaction_id\n    - function: private::foreign_from\n    - impl: impl ForeignFrom<(\n&hyperswitch_domain_models::payments::AmountDetails,\n&hyperswitch_domain_models::payments::payment_attempt::AttemptAmountDetails,\n)> for api_models::payments::ConfirmIntentAmountDetailsResponse\n\n**sample_data.rs**\n  Modify existing code\n\n**outgoing_webhook_retry.rs**\n  Modify existing code\n\n**payment_sync.rs**\n  Modify existing code\n\n**payments.rs**\n  Remove:\n    - function: pub::get_total_capturable_amount\n    - function: pub::with_source\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::HeaderPayload\n    - impl: impl PaymentsRequest\n    - impl: impl HeaderPayload\n    - impl: impl PaymentsRequest\n  Add:\n    - function: pub::get_feature_metadata_as_value\n    - function: pub::get_connector_metadata_as_value\n    - function: pub::get_allowed_payment_method_types_as_value\n    - function: pub::get_order_details_as_value\n    - struct: pub::AmountDetailsResponse\n    - struct: pub::ConfirmIntentAmountDetailsResponse\n    - struct: pub::PaymentsConfirmIntentRequest\n    - struct: pub::ErrorDetails\n    - struct: pub::PaymentsConfirmIntentResponse\n\n**payments2.rs**\n  Modify existing code\n\n**types.rs**\n  Add:\n    - function: pub::get_string_repr\n    - function: private::from_str\n    - function: pub::get_string_repr\n    - struct: pub::BrowserInformation\n    - impl: impl Url\n    - impl: impl FromStr for ClientSecret\n\n**payment_attempt.rs**\n  Modify existing code\n\n**payment_attempt.rs**\n  Modify existing code"}
