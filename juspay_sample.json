{
  "repo": "juspay/hyperswitch",
  "instance_id": "juspay__hyperswitch-9755",
  "problem_statement": "Bug: [BUG] Migration runner fails due to Just already present\n\n\n\n### Description:\n\nIn `docker-compose.yml`, the `migration-runner` service fails if we run `docker compose up` more than once, because, the `just` installer doesn't handle the case where just is already installed.\n\n### Solution:\n\nAdd a conditional check to run `just` installer only if `just` is not present already.",
  "patch": "diff --git a/docker-compose.yml b/docker-compose.yml\nindex e16dd74466b..4e2600c8344 100644\n--- a/docker-compose.yml\n+++ b/docker-compose.yml\n@@ -63,7 +63,9 @@ services:\n       bash -c \"\n       apt-get update && apt-get install -y curl xz-utils &&\n       curl --proto '=https' --tlsv1.2 -LsSf https://github.com/diesel-rs/diesel/releases/latest/download/diesel_cli-installer.sh | bash &&\n-      curl --proto '=https' --tlsv1.2 -sSf https://just.systems/install.sh | bash -s -- --to /usr/local/bin &&\n+      if ! command -v just >/dev/null 2>&1; then\n+        curl --proto '=https' --tlsv1.2 -sSf https://just.systems/install.sh | bash -s -- --to /usr/local/bin\n+      fi &&\n       export PATH=\"$${PATH}:$${HOME}/.cargo/bin\" &&\n       just migrate\"\n     working_dir: /app\n",
  "test_patch": "",
  "created_at": "2025-10-08T10:15:48Z",
  "hints_text": "## Type of Change\r\n<!-- Put an `x` in the boxes that apply -->\r\n\r\n- [x] Bugfix\r\n- [ ] New feature\r\n- [ ] Enhancement\r\n- [ ] Refactoring\r\n- [ ] Dependency updates\r\n- [ ] Documentation\r\n- [ ] CI/CD\r\n\r\n## Description\r\n<!-- Describe your changes in detail -->\r\nThe migration-runner service in the `docker-compose.yml` file fails during a second deployment as `just` installer raises `just already installed` error. This PR fixes that issue issue by adding a conditional statement which calls the just installer only when just command is not available.\r\n\r\n### Additional Changes\r\n\r\n- [ ] This PR modifies the API contract\r\n- [ ] This PR modifies the database schema\r\n- [ ] This PR modifies application configuration/environment variables\r\n\r\n<!--\r\nProvide links to the files with corresponding changes.\r\n\r\nFollowing are the paths where you can find config files:\r\n1. `config`\r\n2. `crates/router/src/configs`\r\n3. `loadtest/config`\r\n-->\r\n\r\n\r\n## Motivation and Context\r\n<!--\r\nWhy is this change required? What problem does it solve?\r\nIf it fixes an open issue, please link to the issue here.\r\n\r\nIf you don't have an issue, we'd recommend starting with one first so the PR\r\ncan focus on the implementation (unless it is an obvious bug or documentation fix\r\nthat will have little conversation).\r\n-->\r\nN/A\r\n\r\n## How did you test it?\r\n<!--\r\nDid you write an integration/unit/API test to verify the code changes?\r\nOr did you test this change manually (provide relevant screenshots)?\r\n-->\r\nRan `docker compose up -d` twice.\r\n<img width=\"476\" height=\"491\" alt=\"Screenshot 2025-10-08 at 3 44 53\u202fPM\" src=\"https://github.com/user-attachments/assets/c9de99cd-ac3a-4ab9-8c4e-5a1bb8d48d84\" />\r\n\r\n\r\n## Checklist\r\n<!-- Put an `x` in the boxes that apply -->\r\n\r\n- [x] I formatted the code `cargo +nightly fmt --all`\r\n- [x] I addressed lints thrown by `cargo clippy`\r\n- [x] I reviewed the submitted code\r\n- [ ] I added unit tests for my changes where possible\r\n",
  "base_commit": "b52aafa8873fc4704bd69014cc457daf32d5523c"
}