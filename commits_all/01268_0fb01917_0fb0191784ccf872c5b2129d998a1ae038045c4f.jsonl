{"prompt": "feat(payment_method_session): implement payment methods session confirm (#7248)\n\nCo-authored-by: Sanchith Hegde <sanchith.hegde@juspay.in>\nCo-authored-by: hyperswitch-bot[bot] <148525504+hyperswitch-bot[bot]@users.noreply.github.com>\nCo-authored-by: Anurag Thakur <anurag.thakur@juspay.in>\nCo-authored-by: Pa1NarK <69745008+pixincreate@users.noreply.github.com>\nCo-authored-by: Shankar Singh C <83439957+ShankarSinghC@users.noreply.github.com>\nCo-authored-by: Sai Harsha Vardhan <56996463+sai-harsha-vardhan@users.noreply.github.com>\nCo-authored-by: hrithikesh026 <hrithikesh.vm@juspay.in>\nCo-authored-by: Debarati Ghatak <88573135+cookieg13@users.noreply.github.com>\nCo-authored-by: awasthi21 <107559116+awasthi21@users.noreply.github.com>\nCo-authored-by: Gnanasundari24 <118818938+Gnanasundari24@users.noreply.github.com>\nCo-authored-by: github-actions <41898282+github-actions[bot]@users.noreply.github.com>\nCo-authored-by: Arindam Sahoo <88739246+arindam-sahoo@users.noreply.github.com>\nCo-authored-by: Arindam Sahoo <arindam.sahoo@Arindam-Sahoo-F565040VFJ.local>\nCo-authored-by: Sakil Mostak <73734619+Sakilmostak@users.noreply.github.com>\nCo-authored-by: AkshayaFoiger <131388445+AkshayaFoiger@users.noreply.github.com>\nCo-authored-by: Riddhiagrawal001 <50551695+Riddhiagrawal001@users.noreply.github.com>\nCo-authored-by: Suman Maji <77887221+sumanmaji4@users.noreply.github.com>\nCo-authored-by: Sandeep Kumar <83278309+tsdk02@users.noreply.github.com>\nCo-authored-by: Debarshi Gupta <debarshigupta47@gmail.com>\nCo-authored-by: Debarshi Gupta <debarshi.gupta@Debarshi-Gupta-CM92YWDXFD.local>\nCo-authored-by: Sanchith Hegde <22217505+SanchithHegde@users.noreply.github.com>\nCo-authored-by: Swangi Kumari <85639103+swangi-kumari@users.noreply.github.com>\nCo-authored-by: pranav-arjunan <pranav.arjunan@juspay.in>\nCo-authored-by: Kashif <kashif.dev@protonmail.com>\nCo-authored-by: Sagnik Mitra <83326850+ImSagnik007@users.noreply.github.com>\nCo-authored-by: sweta-kumari-sharma <77436883+Sweta-Kumari-Sharma@users.noreply.github.com>\nCo-authored-by: shivansh.mathur <shivansh.mathur@juspay.in>", "response": "Files to modify:\n\n\n**events.rs**\n  Remove:\n    - impl: impl ApiEventMetric for PaymentMethodsSessionResponse\n  Add:\n    - impl: impl ApiEventMetric for PaymentMethodsSessionUpdateRequest\n    - impl: impl ApiEventMetric for PaymentMethodSessionResponse\n\n**payment.rs**\n  Remove:\n    - function: private::get_api_event_type\n    - function: private::get_api_event_type\n    - impl: impl ApiEventMetric for payments::PaymentsResponse\n    - impl: impl ApiEventMetric for PaymentsConfirmIntentResponse\n\n**payment_methods.rs**\n  Remove:\n    - struct: pub::PaymentMethodsSessionResponse\n  Add:\n    - struct: pub::ConnectorTokenDetails\n    - struct: pub::PaymentMethodsSessionUpdateRequest\n    - struct: pub::PaymentMethodSessionConfirmRequest\n    - struct: pub::PaymentMethodSessionResponse\n    - struct: pub::AuthenticationDetails\n\n**payments.rs**\n  Remove:\n    - struct: pub::PaymentsResponse\n    - struct: pub::PaymentsConfirmIntentResponse\n  Add:\n    - function: pub::new_for_zero_auth_payment\n    - function: private::try_from\n    - impl: impl AmountDetails\n    - impl: impl TryFrom<payment_methods::CardDetail> for Card\n\n**webhooks.rs**\n  Modify existing code\n\n**enums.rs**\n  Add:\n    - enum: pub::ConnectorTokenStatus\n\n**payment_methods.rs**\n  Remove:\n    - struct: pub::PaymentMethodsSessionResponse\n  Add:\n    - struct: pub::ConnectorTokenDetails\n    - struct: pub::PaymentMethodsSessionUpdateRequest\n    - struct: pub::PaymentMethodSessionConfirmRequest\n    - struct: pub::PaymentMethodSessionResponse\n    - struct: pub::AuthenticationDetails\n\n**macros.rs**\n  Modify existing code\n\n**payment_attempt.rs**\n  Modify existing code\n\n**payment_method.rs**\n  Add:\n    - function: private::deref\n    - function: private::deref_mut\n    - function: pub::insert_payment_token_reference_record\n    - function: private::from_sql\n    - struct: pub::CommonMandateReference\n    - impl: impl std::ops::Deref for PaymentsTokenReference\n    - impl: impl std::ops::DerefMut for PaymentsTokenReference\n    - impl: impl diesel::deserialize::FromSql<diesel::sql_types::Jsonb, DB> for CommonMandateReference\n\n**payment_methods_session.rs**\n  Remove:\n    - struct: pub::PaymentMethodsSession\n  Add:\n    - function: pub::apply_changeset\n    - struct: pub::PaymentMethodSession\n    - struct: pub::PaymentMethodsSessionUpdateInternal\n    - impl: impl PaymentMethodSession\n\n**api.rs**\n  Add:\n    - function: pub::get_json_body\n    - impl: impl ApplicationResponse<R>\n\n**mandates.rs**\n  Remove:\n    - struct: pub::PaymentsMandateReferenceRecord\n  Add:\n    - function: private::deref_mut\n    - function: pub::insert_payment_token_reference_record\n    - function: private::from\n    - function: private::from\n    - struct: pub::ConnectorTokenReferenceRecord\n    - struct: pub::CommonMandateReference\n    - impl: impl std::ops::DerefMut for PaymentsTokenReference\n    - impl: impl From<diesel_models::PaymentsTokenReference> for PaymentsTokenReference\n    - impl: impl From<PaymentsTokenReference> for diesel_models::PaymentsTokenReference\n\n**merchant_account.rs**\n  Modify existing code\n\n**payment_methods.rs**\n  Remove:\n    - struct: pub::PaymentMethodsSessionResponse\n  Add:\n    - struct: pub::ConnectorTokenDetails\n    - struct: pub::PaymentMethodsSessionUpdateRequest\n    - struct: pub::PaymentMethodSessionConfirmRequest\n    - struct: pub::PaymentMethodSessionResponse\n    - struct: pub::AuthenticationDetails\n\n**payment_attempt.rs**\n  Modify existing code\n\n**router_data.rs**\n  Modify existing code\n\n**router_response_types.rs**\n  Modify existing code\n\n**openapi_v2.rs**\n  Modify existing code\n\n**payment_method.rs**\n  Add:\n    - function: private::deref\n    - function: private::deref_mut\n    - function: pub::insert_payment_token_reference_record\n    - function: private::from_sql\n    - struct: pub::CommonMandateReference\n    - impl: impl std::ops::Deref for PaymentsTokenReference\n    - impl: impl std::ops::DerefMut for PaymentsTokenReference\n    - impl: impl diesel::deserialize::FromSql<diesel::sql_types::Jsonb, DB> for CommonMandateReference\n\n**payments.rs**\n  Remove:\n    - struct: pub::PaymentsResponse\n    - struct: pub::PaymentsConfirmIntentResponse\n  Add:\n    - function: pub::new_for_zero_auth_payment\n    - function: private::try_from\n    - impl: impl AmountDetails\n    - impl: impl TryFrom<payment_methods::CardDetail> for Card\n\n**admin.rs**\n  Modify existing code\n\n**payment_methods.rs**\n  Remove:\n    - struct: pub::PaymentMethodsSessionResponse\n  Add:\n    - struct: pub::ConnectorTokenDetails\n    - struct: pub::PaymentMethodsSessionUpdateRequest\n    - struct: pub::PaymentMethodSessionConfirmRequest\n    - struct: pub::PaymentMethodSessionResponse\n    - struct: pub::AuthenticationDetails\n\n**transformers.rs**\n  Add:\n    - function: pub::generate_payment_method_session_response\n    - function: private::foreign_from\n    - impl: impl transformers::ForeignFrom<api_models::payment_methods::ConnectorTokenDetails> for hyperswitch_domain_models::mandates::ConnectorTokenReferenceRecord\n\n**payments.rs**\n  Remove:\n    - struct: pub::PaymentsResponse\n    - struct: pub::PaymentsConfirmIntentResponse\n  Add:\n    - function: pub::new_for_zero_auth_payment\n    - function: private::try_from\n    - impl: impl AmountDetails\n    - impl: impl TryFrom<payment_methods::CardDetail> for Card\n\n**payment_confirm_intent.rs**\n  Modify existing code\n\n**payment_response.rs**\n  Add:\n    - function: private::save_pm_and_mandate\n\n**tokenization.rs**\n  Modify existing code\n\n**transformers.rs**\n  Add:\n    - function: pub::generate_payment_method_session_response\n    - function: private::foreign_from\n    - impl: impl transformers::ForeignFrom<api_models::payment_methods::ConnectorTokenDetails> for hyperswitch_domain_models::mandates::ConnectorTokenReferenceRecord\n\n**payouts.rs**\n  Modify existing code\n\n**incoming_v2.rs**\n  Modify existing code\n\n**recovery_incoming.rs**\n  Modify existing code\n\n**kafka_store.rs**\n  Add:\n    - function: private::update_payment_method_session\n\n**payment_method_session.rs**\n  Add:\n    - function: private::update_payment_method_session\n    - function: private::update_payment_method_session\n\n**lib.rs**\n  Modify existing code\n\n**routes.rs**\n  Modify existing code\n\n**app.rs**\n  Remove:\n    - struct: pub::PaymentMethodsSession\n    - impl: impl PaymentMethodsSession\n  Add:\n    - struct: pub::PaymentMethodSession\n    - impl: impl PaymentMethodSession\n\n**lock_utils.rs**\n  Modify existing code\n\n**payment_methods.rs**\n  Remove:\n    - struct: pub::PaymentMethodsSessionResponse\n  Add:\n    - struct: pub::ConnectorTokenDetails\n    - struct: pub::PaymentMethodsSessionUpdateRequest\n    - struct: pub::PaymentMethodSessionConfirmRequest\n    - struct: pub::PaymentMethodSessionResponse\n    - struct: pub::AuthenticationDetails\n\n**payments.rs**\n  Remove:\n    - struct: pub::PaymentsResponse\n    - struct: pub::PaymentsConfirmIntentResponse\n  Add:\n    - function: pub::new_for_zero_auth_payment\n    - function: private::try_from\n    - impl: impl AmountDetails\n    - impl: impl TryFrom<payment_methods::CardDetail> for Card\n\n**types.rs**\n  Modify existing code\n\n**errors.rs**\n  Modify existing code"}
